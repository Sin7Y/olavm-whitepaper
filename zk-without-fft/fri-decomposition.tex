\subsection{FRI Decomposition}

We can write a polynomial $f(x)$ as the sum of odd and even power terms: $f(x)=f_e(x^2)+xf_o(x^2)$.
Let $\tilde{f}(x)=f(-x)$, then
\[
    f_e(x^2) = \frac{f(x)+f(-x)}{2} = \frac{f(x)+\tilde{f}(x)}{2},
    \quad
    f_o(x^2) = \frac{f(x)-f(-x)}{2x} = \frac{f(x)-\tilde{f}(x)}{2x}.
\]

\begin{lemma} \label{lemma:fri-decomposition}
    Let $H$ be an even-order subgroup of $\mathbb{F}_p^*$, $a,b,c,d$ be polynomials on the Lagrange basis of $H$, and $r$ be a random number.
    Let $H'=\{h^2 : h \in H\}$,
    \begin{align*}
        a' &= a_e + ra_o, \\
        b' &= b_e + rb_o, \\
        c' &= c_e + rc_o, \\
        d' &= r^2d_e/x + rd_o,
    \end{align*}
    which are polynomials on the Lagrange basis of $H'$, then
    \[
        \left\{ \begin{aligned}
            & ab = c + d \\
            & a\tilde{b} = c - d
        \end{aligned} \right.
        \ \Longleftrightarrow \
        \left\{ \begin{aligned}
            & a'b' = c' + d' \\
            & a'\tilde{b}' = c' - d'
        \end{aligned} \right. .
    \]
\end{lemma}
The proof of Lemma \ref{lemma:fri-decomposition} can refer to \cite{website:hadamard-check-without-fft}.

We can build a recursive proof protocol without FFT using Lemma \ref{lemma:fri-decomposition}.
Set $\omega$ to be a primitive root of unity of order $2^m$, $H_0=\langle\omega\rangle$ be the subgroup generated by $\omega$.
In order to prove the polynomial equation $ab=h$, we construct the polynomial on the Lagrange basis of $H_0$: $a^{(0)}=a$, $b^{(0)}=b$.
The prover first calculates the polynomials $c^{(0)}$, $d^{(0)}$, which produces
\[
    \left\{ \begin{aligned}
        & a^{(0)}b^{(0)} = c^{(0)} + d^{(0)} \\
        & a^{(0)}\tilde{b}^{(0)} = c^{(0)} - d^{(0)}
    \end{aligned} \right.
\]
and sends the KZG commitment of $a_0,b_0,c_0,d_0$ to the verifier.

The recursive proof requires $m$ rounds in total. In the $k$-th round, the prover starts from the commitments of $a^{(k)}_e,a^{(k)}_o,b^{(k)}_e,b^{(k)}_o,c^{(k)}_e,c^{(k)}_o,d^{(k)}_e/x,d^{(k)}_o$ that correspond to four polynomials $a^{(k)},b^{(k)},c^{(k)},d^{(k)}$ on the Lagrange basis of $H_k=\langle\omega^{2^k}\rangle$ and sends them to the verifier. The verifier replies with a random number $r$ and computes the corresponding commitment of $a',b',c',d'$.
In the next round, replace $H_k$ with $H_{k+1}$ and replace $a,b,c,d$ with $a^{(k+1)}=a',b^{(k+1)}=b',c^{(k+1)}=c',d^{(k+1)}=d'$ until $a^{(m)},b^{(m)},c^{(m)},d^{(m)}$ are reduced to constants after $m$ rounds and $|H_m|=1$.

Finally, the verifier randomly picks a point $z$ and performs multiple consistency verifications. For each polynomial $a^{(k)},b^{(k)},c^{(k)}$, the verifier needs to verify
\[
    \left\{ \begin{aligned}
        & f(z) = f_e(z^2) + zf_o(z^2) \\
        & f(-z) = f_e(z^2) - zf_o(z^2)
    \end{aligned} \right. .
\]
For polynomial $d^{(k)}$, the verifier needs to verify
\[
    \left\{ \begin{aligned}
        & f(z) = z^2(f_e/x)(z^2) + zf_o(z^2) \\
        & f(-z) = z^2(f_ex)(z^2) - zf_o(z^2)
    \end{aligned} \right. ,
\]
where $f$ represents some $a,b,c,d$, and $z$ is a random point.

The verifier also needs to verify the boundary conditions
\[
    \left\{ \begin{aligned}
        & a^{(m)}(z)b^{(m)}(z) = c^{(m)}(z) + d^{(m)}(z) \\
        & a^{(m)}(z)\tilde{b}^{(m)}(z) = c^{(m)}(z) - d^{(m)}(z)
    \end{aligned} \right. .
\]
